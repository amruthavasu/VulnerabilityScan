package start;

public class CreateTables {

	/**
	 * Creates all the tables required for the application.
	 */
	public void createAllTables() {
		// Create HOST table
		String createStatement = "CREATE TABLE HOST (IPADDR VARCHAR(15) PRIMARY KEY, THREAD_STATE VARCHAR(15))";
		if (!DatabaseManager.ifTableExixts("HOST")) {
			DatabaseManager.executeQuery(createStatement);
		}

		// Create PORT table
		createStatement = "CREATE TABLE PORT (PORT_ID INT NOT NULL, " + "STATE VARCHAR(10), "
				+ "SERVICE VARCHAR(50) DEFAULT 'Unknown', " + "PRODUCT VARCHAR(100) DEFAULT 'Unknown', "
				+ "VERSION VARCHAR(50) DEFAULT 'Unknown', " + "IPADDR VARCHAR(15) NOT NULL, "
				+ "PRIMARY KEY (PORT_ID, IPADDR), " + "FOREIGN KEY (IPADDR) REFERENCES HOST(IPADDR))";
		if (!DatabaseManager.ifTableExixts("PORT")) {
			DatabaseManager.executeQuery(createStatement);
		}
		
		// Create VULNERABILITY table
		createStatement = "CREATE TABLE VULNERABILITIES "
						+ "(IPADDR VARCHAR(15) NOT NULL, "
						+ "PORTID INT, "
						+ "VULN VARCHAR(200), "
						+ "PRIMARY KEY (IPADDR, PORTID, VULN),"
						+ "FOREIGN KEY (IPADDR) REFERENCES HOST(IPADDR))";
		if (!DatabaseManager.ifTableExixts("VULNERABILITIES")) {
			DatabaseManager.executeQuery(createStatement);
		}
		
		// Create CERTIFICATES table
				createStatement = "CREATE TABLE CERTIFICATE "
								+ "(IPADDR VARCHAR(15) NOT NULL, "
								+ "PORTID INT, "
								+ "CN VARCHAR(200), "
								+ "ISSUER VARCHAR(200),"
								+ "KEY_LENGTH INT,"
								+ "SIGNATURE_ALOGRITHM VARCHAR(50),"
								+ "EXPIRY_DATE DATE,"
								+ "PRIMARY KEY (IPADDR, PORTID),"
								+ "FOREIGN KEY (IPADDR) REFERENCES HOST(IPADDR))";
				if (!DatabaseManager.ifTableExixts("VULNERABILITIES")) {
					DatabaseManager.executeQuery(createStatement);
				}
	}
}
